monitor = eDP-1,preferred,auto,1

exec-once = waybar
exec-once = systemctl start hyprpolkitagent --user
# exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
# exec-once = solaar -w hide
exec-once = dunst
# exec-once = poweralertd

env = XCURSOR_SIZE,24
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland
env = LIBVA_DRIVER_NAME,nvidia
env = GTK_USE_PORTAL,1

env = NIXOS_OZONE_WL,true env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = HYPRCURSOR_THEME,catppuccin-frappe-green-cursors

ecosystem:no_update_news = true
ecosystem:no_donation_nag = true

misc:enable_anr_dialog = false
misc:vrr = 1

device {
	name = ftcs0038:00-2808:0106-touchpad

	sensitivity = 1
}

input {
	kb_layout = gb
	kb_options = ctrl:nocaps

	repeat_rate = 50
	repeat_delay = 300

	touchpad {
		scroll_factor = 0.75
		clickfinger_behavior = true
		tap-and-drag = true
		drag_lock = 2
	}

	sensitivity = 1

	accel_profile=flat
}

cursor:hide_on_key_press = true

general {
	gaps_in = 0
	gaps_out = 0
	border_size = 3

	col.inactive_border = 0xff077000
	col.active_border = 0xff00AA00

	layout = dwindle

	no_focus_fallback = true
}

dwindle {
	preserve_split = yes
	force_split = 2
}

master {
	allow_small_split = true
	mfact = 0.5
	orientation = right
}

decoration {
	rounding = 0

	blur {
		enabled = true
		size = 2
		passes = 1
		ignore_opacity = false
		vibrancy = 0
		new_optimizations = true
	}

	shadow {
		enabled = false
	}

	# screen_shader = ~/.dotfiles/hypr/shader.frag
}

layerrule = blur, waybar

# debug:damage_tracking = false
# debug:overlay = true

# experimental:xx_color_management_v4 = true

animations {
	enabled = false
}

misc {
	force_default_wallpaper = true
	disable_hyprland_logo = true
}

$BROWSER  = firefox
$TERM = alacritty
$TERMINAL = $TERM
$APP_TERM = alacritty -o font.size=12 -o window.opacity=0.75

env = BROWSER , $BROWSER
env = TERM    , $TERM
env = TERMINAL, $TERM

# bindings
bind  = SUPER               , V                    , togglefloating
bind  = SUPER               , F                    , fullscreen
bind  = SUPER               , code:36              , exec, $TERM
bind  = SUPER          SHIFT, Q                    , killactive
bind  = SUPER               , Q                    , exec           , bash /home/redstonetrail/.dotfiles/scripts/killmode
bind  = SUPER          SHIFT, E                    , exit
bind  = SUPER          SHIFT, C                    , exec           , ~/.dotfiles/scripts/reset-hyprland
bind  = SUPER          SHIFT, V                    , exec           , virt-manager
bind  = SUPER               , P                    , pin
bind  = SUPER               , B                    , exec           , $BROWSER
bind  = SUPER       ALT     , B                    , exec           , google-chrome-stable
bind  = SUPER          SHIFT, B                    , exec           , proxychains4 $BROWSER
bind  = SUPER          SHIFT, S                    , exec           , ~/.dotfiles/scripts/lock
bind  = SUPERCONTROL   SHIFT, S                    , exec           , ~/.dotfiles/scripts/lock & sleep 1 && systemctl hibernate
bind  = SUPER       ALTSHIFT, S                    , exec           , ~/.dotfiles/scripts/lock & sleep 1 && systemctl suspend
bind  =                     , switch:Lid Switch    , exec           , /home/redstonetrail/.dotfiles/scripts/lock lid
bind  = SUPER               , 1                    , workspace      , 1
bind  = SUPER               , 2                    , workspace      , 2
bind  = SUPER               , 3                    , workspace      , 3
bind  = SUPER               , 4                    , workspace      , 4
bind  = SUPER               , 5                    , workspace      , 5
bind  = SUPER               , 6                    , workspace      , 6
bind  = SUPER               , 7                    , workspace      , 7
bind  = SUPER               , 8                    , workspace      , 8
bind  = SUPER               , 9                    , workspace      , 9
bind  = SUPER               , 0                    , workspace      , 10
bind  = SUPER          SHIFT, 1                    , movetoworkspace, 1
bind  = SUPER          SHIFT, 2                    , movetoworkspace, 2
bind  = SUPER          SHIFT, 3                    , movetoworkspace, 3
bind  = SUPER          SHIFT, 4                    , movetoworkspace, 4
bind  = SUPER          SHIFT, 5                    , movetoworkspace, 5
bind  = SUPER          SHIFT, 6                    , movetoworkspace, 6
bind  = SUPER          SHIFT, 7                    , movetoworkspace, 7
bind  = SUPER          SHIFT, 8                    , movetoworkspace, 8
bind  = SUPER          SHIFT, 9                    , movetoworkspace, 9
bind  = SUPER          SHIFT, 0                    , movetoworkspace, 10
binde = SUPER          SHIFT, L                    , movewindow     , r
binde = SUPER          SHIFT, H                    , movewindow     , l
binde = SUPER          SHIFT, J                    , movewindow     , d
binde = SUPER          SHIFT, K                    , movewindow     , u
binde = SUPER       ALT     , L                    , moveactive     ,  10   0
binde = SUPER       ALT     , H                    , moveactive     , -10   0
binde = SUPER       ALT     , J                    , moveactive     ,   0  10
binde = SUPER       ALT     , K                    , moveactive     ,   0 -10
binde = SUPER       ALTSHIFT, L                    , moveactive     ,  1  0
binde = SUPER       ALTSHIFT, H                    , moveactive     , -1  0
binde = SUPER       ALTSHIFT, J                    , moveactive     ,  0  1
binde = SUPER       ALTSHIFT, K                    , moveactive     ,  0 -1
bind  = SUPER               , h                    , movefocus      , l
bind  = SUPER               , l                    , movefocus      , r
bind  = SUPER               , k                    , movefocus      , u
bind  = SUPER               , j                    , movefocus      , d
bind  = SUPER               , tab                  , cyclenext      , visible
binde = SUPERCONTROL        , h                    , resizeactive   , -10  0
binde = SUPERCONTROL        , l                    , resizeactive   ,  10  0
binde = SUPERCONTROL        , j                    , resizeactive   ,   0  10
binde = SUPERCONTROL        , k                    , resizeactive   ,   0 -10
binde = SUPERCONTROL   SHIFT, h                    , resizeactive   , -1  0
binde = SUPERCONTROL   SHIFT, l                    , resizeactive   ,  1  0
binde = SUPERCONTROL   SHIFT, j                    , resizeactive   ,  0  1
binde = SUPERCONTROL   SHIFT, k                    , resizeactive   ,  0 -1
bind  = SUPER               , m                    , togglesplit
bindm = SUPER               , mouse:272            , movewindow
bindm = SUPER               , mouse:273            , resizewindow
bind  = SUPER               , XF86AudioMute        , exec           , ~/.dotfiles/scripts/mute-current-app
bind  =                     , XF86AudioMute        , exec           , pactl set-sink-mute     @DEFAULT_SINK@ toggle
binde =                     , XF86AudioRaiseVolume , exec           , pactl set-sink-volume   @DEFAULT_SINK@ +5%
binde =                     , XF86AudioLowerVolume , exec           , pactl set-sink-volume   @DEFAULT_SINK@ -5%
binde =                SHIFT, XF86AudioRaiseVolume , exec           , pactl set-sink-volume   @DEFAULT_SINK@ +1%
binde =                SHIFT, XF86AudioLowerVolume , exec           , pactl set-sink-volume   @DEFAULT_SINK@ -1%
bind  =                     , XF86AudioMicMute     , exec           , pactl set-source-mute   @DEFAULT_SOURCE@ toggle
binde =             ALT     , XF86AudioRaiseVolume , exec           , pactl set-source-volume @DEFAULT_SOURCE@ +5%
binde =             ALT     , XF86AudioLowerVolume , exec           , pactl set-source-volume @DEFAULT_SOURCE@ -5%
bindl =                     , XF86MonBrightnessUp  , exec           , brightnessctl s +5%
bindl =                     , XF86MonBrightnessDown, exec           , brightnessctl s 5%-
bindl =                SHIFT, XF86MonBrightnessUp  , exec           , brightnessctl s +1%
bindl =                SHIFT, XF86MonBrightnessDown, exec           , brightnessctl s 1%-
bindl =      CONTROL        , XF86MonBrightnessUp  , exec           , brightnessctl s +1
bindl =      CONTROL        , XF86MonBrightnessDown, exec           , brightnessctl s 1-

# Launcher
# windowrulev2 = float, title:^(launcher)$
# windowrulev2 = size 30% 40%, title:^(launcher)$
bind = SUPER, D, exec, fuzzel

# timetable
windowrulev2 = float, title:^(timetable)$
windowrulev2 = size 1184px 624px, title:^(timetable)$
bind = SUPERSHIFT, D, exec, $APP_TERM --title timetable -e sh -c "sleep 0.01; glow ~/school/TIMETABLE.md; read"

# impala window
windowrulev2 = float, title:^(impala)$
windowrulev2 = size 30% 40%, title:^(impala)$
bind = SUPER, N, exec, $APP_TERM --title impala -e impala

# bluetui window
windowrulev2 = float, title:^(bluetui)$
windowrulev2 = size 30% 40%, title:^(bluetui)$
bind = SUPERSHIFT, N, exec, $APP_TERM --title bluetui -e bluetui

# mountui window
windowrulev2 = float, title:^(mountui)$
windowrulev2 = size 30% 40%, title:^(mountui)$
bind = SUPERSHIFT, M, exec, $APP_TERM --title mountui -e mountui

# pulsemixer window
windowrulev2 = float, title:^(pulsemixer)$
windowrulev2 = size 40% 70%, title:^(pulsemixer)$
bind = SHIFT, XF86AudioMute, exec, $APP_TERM --title pulsemixer -e pulsemixer

# Screenshotting
bind =                     , Print, exec, grim -g "$(slurp)" - | wl-copy
bind =                SHIFT, Print, exec, grim - | wl-copy
bind =      CONTROL        , Print, exec, grim -g "$(slurp)"
bind =      CONTROL   SHIFT, Print, exec, grim
bind = SUPER               , Print, exec, hyprctl -j activewindow | jq -r '"\(.at[0]),\(.at[1]) \(.size[0])x\(.size[1])"' | grim -g - - | wl-copy
bind = SUPERCONTROL        , Print, exec, hyprctl -j activewindow | jq -r '"\(.at[0]),\(.at[1]) \(.size[0])x\(.size[1])"' | grim -g -
bind = SUPER       ALT     , Print, exec, hyprctl -j activewindow | jq -r '"\(.at[0]),\(.at[1]) \(.size[0])x\(.size[1])"' | grim -g - - | mpv --keep-open -
bind =             ALT     , Print, exec, grim -g "$(slurp)" - | mpv --keep-open -
bind =             ALTSHIFT, Print, exec, grim - | mpv --keep-open -

# MPRIS with playerctl
bind =             , XF86AudioPlay, exec, playerctl play-pause
bind =             , XF86AudioStop, exec, playerctl stop
bind =             , XF86AudioNext, exec, playerctl next
bind =             , XF86AudioPrev, exec, playerctl previous
bind = CONTROL     , XF86AudioNext, exec, playerctl position 5+
bind = CONTROL     , XF86AudioPrev, exec, playerctl position 5-

# PIP
windowrulev2 = float                   , title:Picture-in-Picture$
windowrulev2 = pin                     , title:Picture-in-Picture$
windowrulev2 = size 20% 19%            , title:Picture-in-Picture$

# waybar toggle
bind = SUPER, escape, exec, killall -s SIGUSR1 waybar

# notifications
binde = SUPER     , space, exec, dunstctl close
binde = SUPERSHIFT, space, exec, dunstctl close-all
binde = SUPERCONTROL, space, exec, dunstctl context

# waydroid
workspace = name:waydroid, gapsin:0, gapsout:0, bordersize:0
windowrulev2 = fullscreen, onworkspace:name:waydroid
bind = SUPER, W, exec, ~/.dotfiles/scripts/waydroid-workspace
